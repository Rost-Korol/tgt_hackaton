# tgt_hackaton
Solution for hackaton
---

# Sound Detection

## Проблема

Описание
TGT Diagnostics – международная нефтесервисная компания. Системы и сервисы TGT Diagnostics предоставляют точную и надежную информацию о техническом состоянии нефтегазовых скважин. Одна из серьезных проблем, с которой сталкиваются при эксплуатации скважины, это вынос песка из нефтегазовых пластов.

Вынос песка влияет на производительность и целостность конструкции скважин и оборудования. Для определения интервалов выноса песка мы используем скважинный шумомер, который измеряет акустические колебания в скважине. Шумомер регистрирует не только шум от движения потоков жидкости и газа в скважине, но и удары песчинок о корпус прибора.

---

## Задача

Разработать автоматический распознаватель удара песчинок на аудиоданных.

---

## Метрика 

f1-score

---

## Данные

В задаче хакатона использовался набор данных, который организаторы получили в лаборатории. Условия при снятии замеров были максимально приближены к реальным условиям скважин: песчинки разных фракций (от 100 мкм до 700 мкм) были подмешаны в поток газа или воды и через маленькое отверстие инжектированы в основной поток, где находился регистрирующий прибор. Скорость чистого 
потока и с песком была разной: от 10 до 100 м/мин. Частота дискретизации аудио данных составляет 117.2 кГц.

Набор данных train.csv состоит из 300 столбцов data_1, data_2, ..., data_300 с амплитудой аудиосигнала и целевого столбца label, который указывает на наличие удара песчинки в этой аудиозаписи (значение 1) или отсутствие такового (значение 0).
Аудиозаписи имеют длину от 49 до 300 сигналов. Если длина аудиозаписи меньше 300, то в столбцах с отсутствующими измерениями будет находиться значение NaN.

---

## Решение

Основа модели взята из работы "Large-Scale Pretrained Audio Neural Networks for Audio Pattern Recognition"
https://arxiv.org/abs/1912.10211

Github работы: 
https://github.com/qiuqiangkong/audioset_tagging_cnn

---

Для распознавания используется свёрточная нейронная сеть (CNN). Модель состоит из 3 блоков.

![model_architecture](https://github.com/Rost-Korol/tgt_hackaton/assets/91683515/bb6a32c3-26a8-4de3-bef5-703b3fbc64f8)

Первый – data transformation – на этом этапе данные перобразуются из звуковой волны в спектрограмму и затем в мелспектрограмму. Также в режиме обучения для того чтобы предотвратить переобучение модели, используются техники аугментации мелспектрограмм – случайным образом выкидываются частоты и отрезки времени. (соответствует наложению пустых вертикальных и горизонтальных полос). Второй этап это общий для CNN моделей – features extractor – который в данном случае состоит из 6 сверточных блоков.

![conv block](https://github.com/Rost-Korol/tgt_hackaton/assets/91683515/cd803326-3283-4b82-919a-b49f8f3e7279)

Дальше получившийся вектор поступает в классификационный блок, который по сути является многослойным персептроном с одним скрытым слоем. На выходе один нейрон, т.к. стоит задача бинарной классификации. Функция активации – сигмоида даст нам вероятнось, округляя которую получаем метку класса 1 или 0. 

---

### Структура проекта

**model_builder** - здень находится класс модели и её блоков

**engine** - функции тренировочной и тестовой петли

**data_setup** - здесь находится класс датасета

**main** - основной файл проекта в котором происходит инициация обучения модели и сохранения её весов

**make_preds** - здесь происходит предсказание на тестовой выборке и сохранение результатов
